# 🔄 手动重启服务指南

## 🚨 问题说明

如果配置环境变量后服务没有自动重启，可以手动触发重启。

## 🔧 方法1：在Zeabur控制台重启（推荐）

### 步骤1：打开服务页面

1. 访问：**https://zeabur.com**
2. 找到项目：**my-telegram-bot33**
3. 点击您的**应用服务**（不是PostgreSQL服务）

### 步骤2：找到重启按钮

在服务页面，查找以下按钮之一：

- **"Restart"** 或 **"重启"** 按钮
- **"Redeploy"** 或 **"重新部署"** 按钮
- **"Actions"** → **"Restart"** 菜单

**位置可能在：**
- 服务页面顶部（工具栏）
- 服务设置页面
- 服务概览页面

### 步骤3：点击重启

1. 点击 **"Restart"** 或 **"重启"** 按钮
2. 确认重启（如果有确认对话框）
3. 等待服务重启（1-2分钟）

### 步骤4：检查服务状态

在服务页面，查看状态指示器：

- 🟡 **Restarting** - 正在重启，请等待
- 🟡 **Building** - 正在构建，请等待
- 🟢 **Running** - 服务运行中
- 🔴 **Failed** - 构建失败，需要查看日志

## 🔧 方法2：重新部署

如果重启按钮不可用，可以重新部署：

### 步骤1：打开服务页面

1. 访问：**https://zeabur.com**
2. 找到项目：**my-telegram-bot33**
3. 点击您的**应用服务**

### 步骤2：找到重新部署按钮

在服务页面，查找：

- **"Redeploy"** 或 **"重新部署"** 按钮
- **"Deployments"** → **"Redeploy"** 菜单

### 步骤3：触发重新部署

1. 点击 **"Redeploy"** 或 **"重新部署"** 按钮
2. 等待部署完成（3-5分钟）

### 步骤4：检查部署状态

在服务页面，查看部署状态：

- 🟡 **Building** - 正在构建
- 🟡 **Deploying** - 正在部署
- 🟢 **Running** - 部署完成，服务运行中
- 🔴 **Failed** - 部署失败，需要查看日志

## 🔍 检查服务是否真的重启了

### 方法1：查看服务状态

在服务页面，查看状态指示器：

**如果状态变化：**
- 从 "Running" → "Restarting" → "Running" ✅ 已重启
- 从 "Running" → "Building" → "Running" ✅ 已重新部署

**如果状态一直是 "Running"：**
- 可能已经重启完成
- 或需要手动触发重启

### 方法2：查看服务日志

1. 在服务页面，找到 **"Logs"** 或 **"日志"** 标签
2. 查看最新的日志信息
3. 查找以下信息：

**如果看到新的启动日志：**
```
INFO:     Started server process [1]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:XXXX
```
✅ 说明服务已重启

**如果日志没有变化：**
- 服务可能没有重启
- 需要手动触发重启

### 方法3：测试健康检查端点

等待服务重启后（1-2分钟），测试：

**访问：**
```
https://my-telegram-bot33.zeabur.app/health
```

**如果返回正常响应：**
- ✅ 服务已重启并运行正常

**如果仍然是502错误：**
- 服务可能还在重启中（等待1-2分钟）
- 或服务启动失败（查看日志）

## ⚠️ 常见问题

### Q1: 找不到重启按钮？

**可能原因：**
- 按钮位置不同
- 界面语言不同

**解决方法：**
1. 查找 **"Actions"** 或 **"操作"** 菜单
2. 查找 **"Settings"** → **"Restart"** 选项
3. 或使用重新部署功能

### Q2: 重启后服务状态是 "Failed"？

**解决方法：**
1. 查看服务日志，找到错误信息
2. 检查环境变量是否都已正确配置
3. 检查 `DATABASE_URL` 是否已设置
4. 根据错误信息修复问题

### Q3: 重启后仍然是502错误？

**可能原因：**
1. 服务还在启动中（等待1-2分钟）
2. 环境变量未配置（导致启动失败）
3. 数据库连接失败

**排查：**
1. 查看服务日志，找到错误信息
2. 检查所有必需的环境变量是否都已配置
3. 确认 `DATABASE_URL` 已设置
4. 提供错误信息，我会帮您解决

### Q4: 服务状态一直是 "Running"，但没有重启？

**解决方法：**
1. 强制重新部署（使用 "Redeploy" 功能）
2. 或等待环境变量生效（可能需要几分钟）

## 📋 完整重启流程

### 推荐流程

1. ✅ **配置所有环境变量**
   - 在服务设置中，添加所有必需的环境变量
   - 保存配置

2. ✅ **手动触发重启**
   - 点击 **"Restart"** 或 **"Redeploy"** 按钮
   - 等待重启完成

3. ✅ **检查服务状态**
   - 查看状态指示器
   - 查看服务日志
   - 测试健康检查端点

4. ✅ **验证配置**
   - 确认服务正常运行
   - 确认数据库连接正常
   - 确认所有功能正常

## 🆘 需要帮助？

如果问题仍然存在，请提供：

1. **服务状态**（Running/Building/Failed）
2. **是否找到重启按钮**（是/否）
3. **服务日志中的错误信息**（如果有）
4. **健康检查响应**（如果服务已启动）

## 📚 相关文档

- [环境变量配置](ZEABUR_ENV_VARS.md)
- [数据库连接指南](ZEABUR_DATABASE_CONNECTION.md)
- [502错误排查步骤](502_TROUBLESHOOTING_STEPS.md)
- [服务状态检查](CHECK_DEPLOYMENT_STATUS.md)




